
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, viewport-fit=cover">
  <title>Путеводитель по Суздалю</title>
  <link rel="stylesheet" href="common.css">
  <link rel="stylesheet" href="place.css">

  <base target="_self">

  <style>
    /* Критические стили для мобильного viewport - загружаются первыми */
    :root {
      --vh: 1vh;
    }
    
    body.is-mobile {
      overflow: hidden;
      position: fixed;
      width: 100%;
      height: 100%;
    }
    
    body.is-mobile #frame {
      height: calc(var(--vh) * 100) !important;
      max-height: calc(var(--vh) * 100) !important;
      min-height: calc(var(--vh) * 100) !important;
      overflow: hidden !important;
      border-radius: 0 !important;
      position: relative;
    }
    
    /* Видео заполняет только видимую область */
    body.is-mobile .temple-video,
    body.is-mobile .video-background,
    body.is-mobile .overlay-gradient {
      height: calc(var(--vh) * 100) !important;
      max-height: calc(var(--vh) * 100) !important;
    }
    
    /* Контент не выходит за пределы */
    body.is-mobile .screen {
      height: calc(var(--vh) * 100) !important;
      max-height: calc(var(--vh) * 100) !important;
      overflow: hidden;
    }
    
    body.is-mobile .scroll-zone {
      height: calc(var(--vh) * 100) !important;
      max-height: calc(var(--vh) * 100) !important;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }
  </style>

<script>
(function() {
  const isMobile = window.matchMedia('(max-width: 1080px)').matches || 
                   /Android|webOS|iPhone|iPad|iPod/i.test(navigator.userAgent);
  
  if (!isMobile) return;
  
  document.body.classList.add('is-mobile');
  
  function updateVH() {
    const vv = window.visualViewport;
    const height = vv ? vv.height : window.innerHeight;
    
    // Устанавливаем --vh как 1/100 от видимой высоты
    document.documentElement.style.setProperty('--vh', `${height * 0.01}px`);
    
    // Дополнительно фиксируем высоту frame напрямую
    const frame = document.getElementById('frame');
    if (frame) {
      frame.style.setProperty('height', `${height}px`, 'important');
    }
  }
  
  // Обновляем при любом изменении viewport
  if (window.visualViewport) {
    window.visualViewport.addEventListener('resize', updateVH);
    window.visualViewport.addEventListener('scroll', updateVH);
  }
  
  window.addEventListener('resize', updateVH);
  window.addEventListener('orientationchange', () => {
    setTimeout(updateVH, 100);
    setTimeout(updateVH, 300); // двойной вызов для надежности
  });
  
  // Немедленно и после загрузки
  updateVH();
  window.addEventListener('load', updateVH);
  setTimeout(updateVH, 100);
  setTimeout(updateVH, 500);
})();
</script>
</head>
<body>


  
  <!-- Стрелки навигации -->
  <div class="temple-nav-arrows" id="templeNavArrows">
    <button class="temple-nav-arrow temple-prev-arrow" id="templePrevArrow">
      <div class="arrow-icon arrow-prev"></div>
    </button>
    <button class="temple-nav-arrow temple-next-arrow" id="templeNextArrow">
      <div class="arrow-icon arrow-next"></div>
    </button>
  </div>

  <div class="container mode-intro" id="frame">
    <a href="categories.html" class="back-button" id="backBtn">
      <div class="back-icon"></div>
    </a>

    <div class="video-background" id="videoPoster"></div>
    
    <!-- ⚠️ ПУСТОЙ SRC, заполняется скриптом -->
    <video class="temple-video" id="bgVideo" muted playsinline webkit-playsinline preload="auto" autoplay loop></video>
    
    <div class="overlay-gradient"></div>

    <div class="screen">
      <div class="scroll-zone" id="scrollZone">
        <div class="top-spacer"></div>

        <div class="title-block" id="titleBlock">
          <h1></h1>
          <div class="entry-note">
            <span></span>
            <div class="small-btn" id="paidBtn">
              <div class="open-icon"></div>
            </div>
          </div>
        </div>

        <div class="hero-details" id="heroDetails">
          <div class="details-header">подробнее:</div>
          <div class="photo-wrapper"></div>
        </div>

        <div id="dropdownsContainer"></div>
      </div>
    </div>

    <div class="bottom-shadow"></div>
  </div>

  <!-- ПОРЯДОК КРИТИЧЕН! -->
  <script src="js/categories/religious_places.js"></script>
  <script src="js/core/categories_config.js"></script>
  <script src="js/core/pages_manager.js"></script>
  <script src="js/core/spa_router.js"></script>
  <script src="js/core/place_menu.js"></script>
  
</body>
</html>



